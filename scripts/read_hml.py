# read hwpx as xml
# SECTION {'Id': '0'}
#    P {'ColumnBreak': 'false', 'InstId': '2304789207', 'PageBreak': 'false', 'ParaShape': '0', 'Style': '0'}
#     TEXT {'CharShape': '0'}
#      SECDEF {'CharGrid': '0', 'FirstBorder': 'false', 'FirstFill': 'false', 'LineGrid': '0', 'OutlineShape': '1', 'SpaceColumns': '1134', 'TabStop': '8000', 'TextDirection': '0', 'TextVerticalWidthHead': '0'}
#       STARTNUMBER {'Equation': '0', 'Figure': '0', 'Page': '0', 'PageStartsOn': 'Both', 'Table': '0'}
#       HIDE {'Border': 'false', 'EmptyLine': 'false', 'Fill': 'false', 'Footer': 'false', 'Header': 'false', 'MasterPage': 'false', 'PageNumPos': 'false'}
#       PAGEDEF {'GutterType': 'LeftOnly', 'Height': '84188', 'Landscape': '0', 'Width': '59528'}
#        PAGEMARGIN {'Bottom': '4252', 'Footer': '4252', 'Gutter': '0', 'Header': '4252', 'Left': '8504', 'Right': '8504', 'Top': '5668'}
#       FOOTNOTESHAPE {}
#        AUTONUMFORMAT {'SuffixChar': ')', 'Superscript': 'false', 'Type': 'Digit'}
#        NOTELINE {'Length': '5cm', 'Type': 'Solid', 'Width': '0.12mm'}
#        NOTESPACING {'AboveLine': '850', 'BelowLine': '567', 'BetweenNotes': '283'}
#        NOTENUMBERING {'NewNumber': '1', 'Type': 'Continuous'}
#        NOTEPLACEMENT {'BeneathText': 'false', 'Place': 'EachColumn'}
#       ENDNOTESHAPE {}
#        AUTONUMFORMAT {'SuffixChar': ')', 'Superscript': 'false', 'Type': 'Digit'}
#        NOTELINE {'Length': '14692344', 'Type': 'Solid', 'Width': '0.12mm'}
#        NOTESPACING {'AboveLine': '850', 'BelowLine': '567', 'BetweenNotes': '0'}
#        NOTENUMBERING {'NewNumber': '1', 'Type': 'Continuous'}
#        NOTEPLACEMENT {'BeneathText': 'false', 'Place': 'EndOfDocument'}
#       PAGEBORDERFILL {'BorferFill': '1', 'FillArea': 'Paper', 'FooterInside': 'false', 'HeaderInside': 'false', 'TextBorder': 'true', 'Type': 'Both'}
#        PAGEOFFSET {'Bottom': '1417', 'Left': '1417', 'Right': '1417', 'Top': '1417'}
#       PAGEBORDERFILL {'BorferFill': '1', 'FillArea': 'Paper', 'FooterInside': 'false', 'HeaderInside': 'false', 'TextBorder': 'true', 'Type': 'Even'}
#        PAGEOFFSET {'Bottom': '1417', 'Left': '1417', 'Right': '1417', 'Top': '1417'}
#       PAGEBORDERFILL {'BorferFill': '1', 'FillArea': 'Paper', 'FooterInside': 'false', 'HeaderInside': 'false', 'TextBorder': 'true', 'Type': 'Odd'}
#        PAGEOFFSET {'Bottom': '1417', 'Left': '1417', 'Right': '1417', 'Top': '1417'}
#      COLDEF {'Count': '1', 'Layout': 'Left', 'SameGap': '0', 'SameSize': 'true', 'Type': 'Newspaper'}
#      CHAR {}
#    P {'ParaShape': '0', 'Style': '0'}
#     TEXT {'CharShape': '0'}
#    P {'ParaShape': '0', 'Style': '0'}
#     TEXT {'CharShape': '0'}
#      CHAR {}
#    P {'ParaShape': '0', 'Style': '0'}
#     TEXT {'CharShape': '0'}
#    P {'ParaShape': '19', 'Style': '21'}
#     TEXT {'CharShape': '7'}
#      CHAR {}
#      EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#       SHAPEOBJECT {'InstId': '1135520469', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '0'}
#        SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1830', 'WidthRelTo': 'Absolute'}
#        POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#        OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#        SHAPECOMMENT {}
#       SCRIPT {}
#      CHAR {}
#      EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#       SHAPEOBJECT {'InstId': '1135520470', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '1'}
#        SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1762', 'WidthRelTo': 'Absolute'}
#        POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#        OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#        SHAPECOMMENT {}
#       SCRIPT {}
#      CHAR {}
#    P {'ParaShape': '20', 'Style': '21'}
#     TEXT {'CharShape': '7'}
#      CHAR {}
#       TAB {}
#      TABLE {'BorderFill': '5', 'CellSpacing': '0', 'ColCount': '3', 'PageBreak': 'Cell', 'RepeatHeader': 'true', 'RowCount': '2'}
#       SHAPEOBJECT {'InstId': '1135520471', 'Lock': 'false', 'NumberingType': 'Table', 'ZOrder': '2'}
#        SIZE {'Height': '4046', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '17690', 'WidthRelTo': 'Absolute'}
#        POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#        OUTSIDEMARGIN {'Bottom': '0', 'Left': '0', 'Right': '0', 'Top': '0'}
#       INSIDEMARGIN {'Bottom': '0', 'Left': '0', 'Right': '0', 'Top': '0'}
#       ROW {}
#        CELL {'BorderFill': '6', 'ColAddr': '0', 'ColSpan': '1', 'Dirty': 'false', 'Editable': 'false', 'HasMargin': 'false', 'Header': 'false', 'Height': '4046', 'Protect': 'false', 'RowAddr': '0', 'RowSpan': '2', 'Width': '3727'}
#         CELLMARGIN {'Bottom': '141', 'Left': '510', 'Right': '510', 'Top': '141'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#          P {'ParaShape': '0', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520472', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '5'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1762', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520473', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '3'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '742', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            EQUATION {'BaseLine': '61', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520474', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '4'}
#              SIZE {'Height': '3630', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '525', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#        CELL {'BorderFill': '6', 'ColAddr': '1', 'ColSpan': '1', 'Dirty': 'false', 'Editable': 'false', 'HasMargin': 'false', 'Header': 'false', 'Height': '2052', 'Protect': 'false', 'RowAddr': '0', 'RowSpan': '1', 'Width': '3585'}
#         CELLMARGIN {'Bottom': '141', 'Left': '510', 'Right': '510', 'Top': '141'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#          P {'ParaShape': '0', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520475', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '6'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '540', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#        CELL {'BorderFill': '6', 'ColAddr': '2', 'ColSpan': '1', 'Dirty': 'false', 'Editable': 'false', 'HasMargin': 'false', 'Header': 'false', 'Height': '2052', 'Protect': 'false', 'RowAddr': '0', 'RowSpan': '1', 'Width': '10378'}
#         CELLMARGIN {'Bottom': '141', 'Left': '510', 'Right': '510', 'Top': '141'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#          P {'ParaShape': '0', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            CHAR {}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520476', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '8'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '3180', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520477', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '9'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '2284', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#       ROW {}
#        CELL {'BorderFill': '6', 'ColAddr': '1', 'ColSpan': '1', 'Dirty': 'false', 'Editable': 'false', 'HasMargin': 'false', 'Header': 'false', 'Height': '1994', 'Protect': 'false', 'RowAddr': '1', 'RowSpan': '1', 'Width': '3585'}
#         CELLMARGIN {'Bottom': '141', 'Left': '510', 'Right': '510', 'Top': '141'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#          P {'ParaShape': '0', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520478', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '7'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1830', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#        CELL {'BorderFill': '6', 'ColAddr': '2', 'ColSpan': '1', 'Dirty': 'false', 'Editable': 'false', 'HasMargin': 'false', 'Header': 'false', 'Height': '1994', 'Protect': 'false', 'RowAddr': '1', 'RowSpan': '1', 'Width': '10378'}
#         CELLMARGIN {'Bottom': '141', 'Left': '510', 'Right': '510', 'Top': '141'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#          P {'ParaShape': '0', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#             SHAPEOBJECT {'InstId': '1135520479', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '10'}
#              SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '5944', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#              SHAPECOMMENT {}
#             SCRIPT {}
#            CHAR {}
#      CHAR {}
#    P {'ParaShape': '21', 'Style': '22'}
#     TEXT {'CharShape': '7'}
#      CHAR {}
#      EQUATION {'BaseLine': '51', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#       SHAPEOBJECT {'InstId': '1135520480', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '11'}
#        SIZE {'Height': '2100', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '14497', 'WidthRelTo': 'Absolute'}
#        POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#        OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#        SHAPECOMMENT {}
#       SCRIPT {}
#      CHAR {}
#    P {'ParaShape': '24', 'Style': '0'}
#     TEXT {'CharShape': '13'}
#      RECTANGLE {'Ratio': '0', 'X0': '0', 'X1': '8504', 'X2': '8504', 'X3': '0', 'Y0': '0', 'Y1': '0', 'Y2': '8504', 'Y3': '8504'}
#       SHAPEOBJECT {'InstId': '1135520481', 'Lock': 'false', 'NumberingType': 'Figure', 'TextFlow': 'LeftOnly', 'ZOrder': '12'}
#        SIZE {'Height': '4433', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '9889', 'WidthRelTo': 'Column'}
#        POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'false', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#        OUTSIDEMARGIN {'Bottom': '567', 'Left': '0', 'Right': '0', 'Top': '0'}
#       DRAWINGOBJECT {}
#        SHAPECOMPONENT {'CurHeight': '9628', 'CurWidth': '42047', 'GroupLevel': '0', 'HorzFlip': 'false', 'InstID': '61778658', 'OriHeight': '8504', 'OriWidth': '8504', 'VertFlip': 'false', 'XPos': '0', 'YPos': '-2'}
#         ROTATIONINFO {'Angle': '0', 'CenterX': '21024', 'CenterY': '4814', 'Rotate': '1'}
#         RENDERINGINFO {}
#          TRANSMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '-2.00000'}
#          SCAMATRIX {'E1': '4.94450', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.13217', 'E6': '2.00000'}
#          ROTMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '0.00000'}
#        LINESHAPE {'Alpha': '0', 'EndCap': 'Flat', 'Style': 'None', 'Width': '33'}
#        SHADOW {'Alpha': '0', 'Color': '0', 'OffsetX': '0', 'OffsetY': '0', 'Type': '0'}
#        DRAWTEXT {'Editable': 'false', 'LastWidth': '42048', 'Name': ''}
#         TEXTMARGIN {'Bottom': '0', 'Left': '0', 'Right': '0', 'Top': '0'}
#         PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Top'}
#          P {'ParaShape': '25', 'Style': '0'}
#           TEXT {'CharShape': '13'}
#            RECTANGLE {'Ratio': '0', 'X0': '0', 'X1': '8504', 'X2': '8504', 'X3': '0', 'Y0': '0', 'Y1': '0', 'Y2': '8504', 'Y3': '8504'}
#             SHAPEOBJECT {'InstId': '1135520483', 'Lock': 'true', 'NumberingType': 'Figure', 'TextWrap': 'InFrontOfText', 'ZOrder': '20'}
#              SIZE {'Height': '1566', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '4252', 'WidthRelTo': 'Absolute'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'true', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Center', 'HorzOffset': '0', 'HorzRelTo': 'Column', 'TreatAsChar': 'false', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '0', 'Right': '0', 'Top': '0'}
#             DRAWINGOBJECT {}
#              SHAPECOMPONENT {'CurHeight': '1565', 'CurWidth': '4252', 'GroupLevel': '0', 'HorzFlip': 'false', 'InstID': '61778660', 'OriHeight': '8504', 'OriWidth': '8504', 'VertFlip': 'false', 'XPos': '304', 'YPos': '0'}
#               ROTATIONINFO {'Angle': '0', 'CenterX': '2126', 'CenterY': '783', 'Rotate': '1'}
#               RENDERINGINFO {}
#                TRANSMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '304.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '0.00000'}
#                SCAMATRIX {'E1': '0.50000', 'E2': '0.00000', 'E3': '-304.00000', 'E4': '0.00000', 'E5': '0.18415', 'E6': '0.00000'}
#                ROTMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '0.00000'}
#              LINESHAPE {'Alpha': '0', 'EndCap': 'Flat', 'Style': 'None', 'Width': '33'}
#              FILLBRUSH {}
#               WINDOWBRUSH {'Alpha': '0', 'FaceColor': '16777215', 'HatchColor': '0'}
#              SHADOW {'Alpha': '0', 'Color': '0', 'OffsetX': '0', 'OffsetY': '0', 'Type': '0'}
#              DRAWTEXT {'Editable': 'false', 'LastWidth': '4252'}
#               TEXTMARGIN {'Bottom': '0', 'Left': '0', 'Right': '0', 'Top': '0'}
#               PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#                P {'ParaShape': '26', 'Style': '0'}
#                 TEXT {'CharShape': '10'}
#                  CHAR {}
#            CHAR {}
#            RECTANGLE {'Ratio': '2', 'X0': '0', 'X1': '8504', 'X2': '8504', 'X3': '0', 'Y0': '0', 'Y1': '0', 'Y2': '8504', 'Y3': '8504'}
#             SHAPEOBJECT {'InstId': '1135520485', 'Lock': 'false', 'NumberingType': 'Figure', 'TextFlow': 'LeftOnly', 'ZOrder': '13'}
#              SIZE {'Height': '3206', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '9920', 'WidthRelTo': 'Column'}
#              POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'true', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#              OUTSIDEMARGIN {'Bottom': '0', 'Left': '57', 'Right': '57', 'Top': '0'}
#             DRAWINGOBJECT {}
#              SHAPECOMPONENT {'CurHeight': '8647', 'CurWidth': '41712', 'GroupLevel': '0', 'HorzFlip': 'false', 'InstID': '61778662', 'OriHeight': '8504', 'OriWidth': '8504', 'VertFlip': 'false', 'XPos': '0', 'YPos': '-6'}
#               ROTATIONINFO {'Angle': '0', 'CenterX': '20856', 'CenterY': '4324', 'Rotate': '1'}
#               RENDERINGINFO {}
#                TRANSMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '-6.00000'}
#                SCAMATRIX {'E1': '4.90499', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.01693', 'E6': '6.00000'}
#                ROTMATRIX {'E1': '1.00000', 'E2': '0.00000', 'E3': '0.00000', 'E4': '0.00000', 'E5': '1.00000', 'E6': '0.00000'}
#              LINESHAPE {'Alpha': '0', 'EndCap': 'Flat', 'Style': 'Solid', 'Width': '113'}
#              SHADOW {'Alpha': '0', 'Color': '0', 'OffsetX': '0', 'OffsetY': '0', 'Type': '0'}
#              DRAWTEXT {'Editable': 'false', 'LastWidth': '41712'}
#               TEXTMARGIN {'Bottom': '850', 'Left': '850', 'Right': '850', 'Top': '1134'}
#               PARALIST {'LineWrap': 'Break', 'LinkListID': '0', 'LinkListIDNext': '0', 'TextDirection': '0', 'VertAlign': 'Center'}
#                P {'ParaShape': '22', 'Style': '23'}
#                 TEXT {'CharShape': '7'}
#                  CHAR {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520487', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '14'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '3207', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#                P {'ParaShape': '22', 'Style': '23'}
#                 TEXT {'CharShape': '7'}
#                  CHAR {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520488', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '15'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1830', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#                P {'ParaShape': '22', 'Style': '23'}
#                 TEXT {'CharShape': '7'}
#                  CHAR {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520489', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '16'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1762', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520490', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '17'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '4215', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#                   LINEBREAK {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520491', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '18'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '4931', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#                  EQUATION {'BaseLine': '85', 'BaseUnit': '1100', 'LineMode': 'false', 'TextColor': '0', 'Version': 'Equation Version 60'}
#                   SHAPEOBJECT {'InstId': '1135520492', 'Lock': 'false', 'NumberingType': 'Equation', 'ZOrder': '19'}
#                    SIZE {'Height': '1125', 'HeightRelTo': 'Absolute', 'Protect': 'false', 'Width': '1830', 'WidthRelTo': 'Absolute'}
#                    POSITION {'AffectLSpacing': 'false', 'AllowOverlap': 'false', 'FlowWithText': 'true', 'HoldAnchorAndSO': 'false', 'HorzAlign': 'Left', 'HorzOffset': '0', 'HorzRelTo': 'Para', 'TreatAsChar': 'true', 'VertAlign': 'Top', 'VertOffset': '0', 'VertRelTo': 'Para'}
#                    OUTSIDEMARGIN {'Bottom': '0', 'Left': '56', 'Right': '56', 'Top': '0'}
#                    SHAPECOMMENT {}
#                   SCRIPT {}
#                  CHAR {}
#            CHAR {}
#          P {'ParaShape': '25', 'Style': '0'}
#           TEXT {'CharShape': '11'}
#          P {'ParaShape': '25', 'Style': '0'}
#           TEXT {'CharShape': '12'}
#      CHAR {}
#    P {'ParaShape': '23', 'Style': '24'}
#     TEXT {'CharShape': '7'}
#      CHAR {}
#       TAB {}
#       TAB {}
#    P {'ParaShape': '23', 'Style': '24'}
#     TEXT {'CharShape': '7'}
#      CHAR {}
#       TAB {}
import sys
import os
import xml.etree.ElementTree as ET
import hml_equation_parser as hp

def print_xml(root, level):
  for child in root:
    print(' ' * level, child.tag, child.text)
    print_xml(child, level + 1)

def print_xml_with_given_tags(root, level, tags):
  for child in root:
    if child.tag in tags:
      if child.tag == 'EQUATION':
        for c in child:
          if c.tag == 'SCRIPT':
            if c.text:
              print(c.text)
              # print('$'+hp.eq2latex(c.text)+'$', end=' ')
      if child.tag == 'CHAR':
        if child.text:
          print(child.text, end='')
      if child.tag == 'TEXT':
        if child.text:
          print(child.text, end='')
      # print(' ' * level, child.tag, child.text)
    print_xml_with_given_tags(child, level + 1, tags)


def read_hwpx():
  f = open(os.path.join(os.path.dirname(__file__), 'test.hml'), 'r')
  tree = ET.parse(f)

  root = tree.getroot()
  # print_xml(root, 0)
  print_xml_with_given_tags(root, 0, ['CHAR', 'TEXT', 'EQUATION'])


def main():
  read_hwpx()

if __name__ == '__main__':
  main()
